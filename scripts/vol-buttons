#!/bin/bash

sleep 5

# Monitor button presses
device="/dev/input/event4"  # Replace with the actual device path
evtest "$device" | while read -r line; do
  # Extract the key code and value from the event
  key_code=$(echo "$line" | grep -oP 'code \K[0-9]+')
  key_value=$(echo "$line" | grep -oP 'value \K[0-9]+')

  # Check if any sink inputs are available
  sink_inputs=$(pacmd list-sink-inputs | grep -c 'index:')

  # Handle button presses (example: volume control)
  if [ "$key_code" == "103" ] && [ "$key_value" == "1" ]; then
    if [ "$sink_inputs" -gt 0 ] && ! pgrep -x "wofi" > /dev/null; then
      wtype -P XF86AudioRaiseVolume
    fi
  elif [ "$key_code" == "108" ] && [ "$key_value" == "1" ]; then
    if [ "$sink_inputs" -gt 0 ] && ! pgrep -x "wofi" > /dev/null; then
      wtype -P XF86AudioLowerVolume
    fi
  fi
done &